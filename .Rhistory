ggsave("thermocycle_NM_all.png", plot = thermocycle_all_NM, bg = 'white',width = 12, height = 8, dpi = 300, units = "in")
#put data into long form
skn_long <- SKN_20C_rep %>%
pivot_longer(
cols = c(`D1`, `D2`, `D3`, `D4`, `D5`),
names_to = "Day",
values_to = "value")
#select only columns needed
skn_long <- skn_long %>%
dplyr::select(c('ID','Treatment','Day','value'))
#get rid of NAs
skn_long <- na.omit(skn_long)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#4DBBD5FF','#E64B35FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#Get Day into a numeric form
#Change day to a numeric variable for analysis
skn_long$Day <- as.factor(skn_long$Day)
#rename treatments
levels(skn_long$Day) <- list('ev' = 'ev', 'daf-2' = 'daf')
#get rid of NAs
skn_long <- na.omit(skn_long)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#4DBBD5FF','#E64B35FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#put data into long form
skn_long <- SKN_20C_rep %>%
pivot_longer(
cols = c(`D1`, `D2`, `D3`, `D4`, `D5`),
names_to = "Day",
values_to = "value")
#select only columns needed
skn_long <- skn_long %>%
dplyr::select(c('ID','Treatment','Day','value'))
#rename treatments
levels(skn_long$Day) <- list('ev' = 'ev', 'daf-2' = 'daf')
#get rid of NAs
skn_long <- na.omit(skn_long)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#4DBBD5FF','#E64B35FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#rename treatments
levels(skn_long$Treatment) <- list('ev' = 'ev', 'daf-2' = 'daf')
#get rid of NAs
skn_long <- na.omit(skn_long)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#4DBBD5FF','#E64B35FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#put data into long form
skn_long <- SKN_20C_rep %>%
pivot_longer(
cols = c(`D1`, `D2`, `D3`, `D4`, `D5`),
names_to = "Day",
values_to = "value")
#select only columns needed
skn_long <- skn_long %>%
dplyr::select(c('ID','Treatment','Day','value'))
#rename treatments
levels(skn_long$Treatment) <- list('ev' = 'ev', 'daf-2' = 'daf')
#get rid of NAs
skn_long <- na.omit(skn_long)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#4DBBD5FF','#E64B35FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#rename treatments
skn_long$Treatment <- as.factor(skn_long$Treatment)
levels(skn_long$Treatment) <- list('ev' = 'ev', 'daf-2' = 'daf')
#get rid of NAs
skn_long <- na.omit(skn_long)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#4DBBD5FF','#E64B35FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=20))+
theme(axis.title.x = element_text(size=20))+
theme(axis.text= element_text(size = 18))+
theme(legend.text = element_text(size = 18))+
scale_color_manual(values=c('#E64B35FF''#4DBBD5FF'))+
skn_20C_p
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=14))+
theme(axis.title.x = element_text(size=14))+
theme(axis.text= element_text(size = 12))+
theme(legend.text = element_text(size = 12))+
scale_color_manual(values=c('#E64B35FF''#4DBBD5FF'))+
skn_20C_p
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=14))+
theme(axis.title.x = element_text(size=14))+
theme(axis.text= element_text(size = 12))+
theme(legend.text = element_text(size = 12))+
scale_color_manual(values=c('#E64B35FF','#4DBBD5FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
#Get Day into a numeric form
#Change day to a numeric variable for analysis
skn_long$Day <- as.factor(skn_long$Day)
levels(skn_long$Day) <- list('1' = 'D1', '2' = 'D2', '3' = 'D3', '4' = 'D4', '5' = 'D5')
skn_long$Day <- as.numeric(skn_long$Day)
#set ev as reference level
skn_long$Treatment <- as.factor(skn_long$Treatment)
skn_long$Treatment <- relevel(skn_long$Treatment, ref = 'ev')
#Age-specific reproduction aanalysis with negative binomial GLMM
m1_SKN <- glmmTMB(value ~ Treatment * Day + (1|ID), family = nbinom2(), data = skn_long)
summary(m1_SKN)
#sum up total number of offspring produced over experiment per individual
totalrep_SKN<-na.omit(as.data.frame.table(tapply(skn_long$value,list(skn_long$Treatment, skn_long$ID),sum)))
#rename columns
names(totalrep_SKN)<-c("Treatment", "Replicate", "Totrep")
#rename factor levels of treatment
totalrep_SKN$Treatment <- revalue(totalrep_SKN$Treatment, c('ev' = 'ev', 'daf' = 'daf-2'))
#create dabestr object for plotting cumming estimation
totrep_SKN_dab <-
totalrep_SKN %>%
load(x =Treatment, y=Totrep,
idx = c('ev','daf-2'))
#create dabestr object for plotting cumming estimation
totrep_SKN_dab <-
totalrep_SKN %>%
load(x =Treatment, y=Totrep,
idx = c('ev','daf-2'))
#get mean differences for plot
totrep_SKN_p <- mean_diff(totrep_SKN_dab)
#cumming estimation plot for LRS in SKN-1 at 20C with daf or ev
tot_rep_SKN_plot <- dabest_plot(totrep_SKN_p, FALSE, raw_marker_spread = 1, swarm_label = 'LRS',custom_palette = 'npg', swarm_x_text = 16, swarm_y_text = 14, contrast_y_text = 16, contrast_x_text = 14, raw_marker_alpha = 0.3, tufte_size = 1 )
tot_rep_SKN_plot
#cumming estimation plot for LRS in SKN-1 at 20C with daf or ev
tot_rep_SKN_plot <- dabest_plot(totrep_SKN_p, FALSE, raw_marker_spread = 1, swarm_label = 'LRS',custom_palette = 'npg', swarm_x_text = 14, swarm_y_text = 14, contrast_y_text = 16, contrast_x_text = 14, raw_marker_alpha = 0.3, tufte_size = 1 )
tot_rep_SKN_plot
#Get rid of NAs
SKN_20C_LS <- na.omit(SKN_20C_LS)
#Rename daf to daf-2
SKN_20C_LS$Treatment.ID <- revalue(SKN_20C_LS$Treatment.ID, c('ev' = 'ev', 'daf' = 'daf-2'))
#Make sure Treatment is a factor
SKN_20C_LS$Treatment.ID <- as.factor(SKN_20C_LS$Treatment.ID)
#Make ev the baseline level
SKN_20C_LS$Treatment.ID <- relevel(SKN_20C_LS$Treatment.ID, ref = 'ev')
#Check factor levels of treatment
levels(SKN_20C_LS$Treatment.ID)
#Get rid of empty levels
SKN_20C_LS$Treatment.ID <- droplevels(SKN_20C_LS$Treatment.ID)
#Plate.ID as a factor not a numerical
SKN_20C_LS$Plate.ID <- as.factor(SKN_20C_LS$Plate.ID)
#Create survival object for SKN-1 mutants at 20C
surv<-survfit(Surv(Age,Event)~Treatment.ID,data=SKN_20C_LS)
#Create survival curve from survival object
SKN_20C_LS_plot <-ggsurvplot(surv, ylab="Survival probability\n", data = SKN_20C_LS, size= 0.8, font.ylab= 18, font.xlab= 18, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(14), font.legend = c(16))
SKN_20C_LS_plot
#Create survival curve from survival object
SKN_20C_LS_plot <-ggsurvplot(surv, ylab="Survival probability\n", data = SKN_20C_LS, size= 0.8, font.ylab= 14, font.xlab= 14, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(12), font.legend = c(12))
SKN_20C_LS_plot
#Use emmeans because of negligible effect of plate.ID
SKN_emm <- emmeans(cox_SKN_20C, ~ Treatment.ID)  # EMMs of treatment
SKN_emm
#Get contrasts
contrasts_SKN <- contrast(SKN_emm, method = "revpairwise")
#make a dataframe out of the contrast summary
df_SKN <- as.data.frame(summary(contrasts_SKN, infer = TRUE))
# Rename columns
names(df_SKN)[names(df_SKN) == "estimate"] <- "logHR"
df_SKN$HR <- exp(df_SKN$logHR)
df_SKN$lower.HR <- exp(df_SKN$asymp.LCL)
#Use emmeans because of negligible effect of plate.ID
SKN_emm <- emmeans(cox_SKN_20C, ~ Treatment.ID)  # EMMs of treatment
#Mixed effects cox model for a effect of daf-2 on SKN-1 mutant lifespan
cox_SKN_20C <- coxme(Surv(Age, Event) ~ Treatment.ID + (1|Plate.ID), data = SKN_20C_LS)
summary(cox_SKN_20C)
Anova(cox_SKN_20C, type = 'II')
#test model
cox.zph(cox_SKN_20C)#OK
#Use emmeans because of negligible effect of plate.ID
SKN_emm <- emmeans(cox_SKN_20C, ~ Treatment.ID)  # EMMs of treatment
SKN_emm
#Get contrasts
contrasts_SKN <- contrast(SKN_emm, method = "revpairwise")
#make a dataframe out of the contrast summary
df_SKN <- as.data.frame(summary(contrasts_SKN, infer = TRUE))
# Rename columns
names(df_SKN)[names(df_SKN) == "estimate"] <- "logHR"
df_SKN$HR <- exp(df_SKN$logHR)
df_SKN$lower.HR <- exp(df_SKN$asymp.LCL)
df_SKN$upper.HR <- exp(df_SKN$asymp.UCL)
#fix labels
df_SKN$Comparison <- df_SKN$contrast
#Create forest plot for differences of treatments within strains
SKN_contrasts <- ggplot(df_SKN, aes(x = Comparison, y = logHR)) +
geom_point(size = 4, color = '#4DBBD5FF') +
geom_hline(yintercept = 0, linetype = "dashed", size = 1.2) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, size = 1.1,color ='#4DBBD5FF')+
coord_flip() +
#scale_x_discrete(labels = c('N2 \n daf-2 - ev','SKN-1 \n daf-2 - ev'))+
labs(
title = "",
x = "Treatment comparison",
y = "Log hazard ratio (HR)"
) +
theme_minimal(base_size = 12)+
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.position = 'none')
SKN_contrasts
#Create forest plot for differences of treatments within strains
SKN_contrasts <- ggplot(df_SKN, aes(x = Comparison, y = logHR)) +
geom_point(size = 4, color = '#4DBBD5FF') +
geom_hline(yintercept = 0, linetype = "dashed", size = 1.2, color = 'grey50') +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, size = 1.1,color ='#4DBBD5FF')+
coord_flip() +
#scale_x_discrete(labels = c('N2 \n daf-2 - ev','SKN-1 \n daf-2 - ev'))+
labs(
title = "",
x = "Treatment comparison",
y = "Log hazard ratio (HR)"
) +
theme_minimal(base_size = 12)+
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.position = 'none')
SKN_contrasts
#Cox mixed effects model
cox_SKN_20C_NM <- coxme(Surv(Age, Event) ~ Treatment.ID + (1|Plate.ID), data = SKN_20C_LS_NM)
summary(cox_SKN_20C_NM)
Anova(cox_SKN_20C_NM, type = 'II')
#Test model
cox.zph(cox_SKN_20C_NM)#OK
#Exclude matricides
SKN_20C_LS_NM <- SKN_20C_LS %>%
filter(Cause != 'M')
#Create survival object
surv<-survfit(Surv(Age,Event)~Treatment.ID,data=SKN_20C_LS_NM)
#Survival plot
SKN_NM_LS_plot <-ggsurvplot(surv, ylab="Survival probability\n", data = SKN_20C_LS_NM, size= 0.8, font.ylab= 18, font.xlab= 18, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(14), font.legend = c(16))
SKN_NM_LS_plot
#Create survival object
surv_SKN_NM<-survfit(Surv(Age,Event)~Treatment.ID,data=SKN_20C_LS_NM)
#Survival plot
SKN_NM_LS_plot <-ggsurvplot(surv_SKN_NM, ylab="Survival probability\n", data = SKN_20C_LS_NM, size= 0.8, font.ylab= 18, font.xlab= 18, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(14), font.legend = c(16))
#Create survival object for SKN-1 mutants at 20C
surv_SKN<-survfit(Surv(Age,Event)~Treatment.ID,data=SKN_20C_LS)
#Create survival curve from survival object
SKN_20C_LS_plot <-ggsurvplot(surv_SKN, ylab="Survival probability\n", data = SKN_20C_LS, size= 0.8, font.ylab= 14, font.xlab= 14, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(12), font.legend = c(12))
SKN_20C_LS_plot
#Exclude matricides
SKN_20C_LS_NM <- SKN_20C_LS %>%
filter(Cause != 'M')
#Create survival object
surv_SKN_NM<-survfit(Surv(Age,Event)~Treatment.ID,data=SKN_20C_LS_NM)
#Survival plot
SKN_NM_LS_plot <-ggsurvplot(surv_SKN_NM, ylab="Survival probability\n", data = SKN_20C_LS_NM, size= 0.8, font.ylab= 18, font.xlab= 18, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(14), font.legend = c(16))
SKN_NM_LS_plot
#Cox mixed effects model
cox_SKN_20C_NM <- coxme(Surv(Age, Event) ~ Treatment.ID + (1|Plate.ID), data = SKN_20C_LS_NM)
summary(cox_SKN_20C_NM)
Anova(cox_SKN_20C_NM, type = 'II')
#Test model
cox.zph(cox_SKN_20C_NM)#OK
#Use emmeans because of negligible effect of plate.ID
SKN_NM_emm <- emmeans(cox_SKN_20C_NM, ~ Treatment.ID)  # EMMs of treatment
SKN_NM_emm
#Get contrasts
contrasts_SKN_NM <- contrast(SKN_NM_emm, method = "revpairwise")
#make a dataframe out of the contrast summary
df_SKN_NM <- as.data.frame(summary(contrasts_SKN_NM, infer = TRUE))
# Rename columns
names(df_SKN_NM)[names(df_SKN_NM) == "estimate"] <- "logHR"
df_SKN_NM$HR <- exp(df_SKN_NM$logHR)
df_SKN_NM$lower.HR <- exp(df_SKN_NM$asymp.LCL)
df_SKN_NM$upper.HR <- exp(df_SKN_NM$asymp.UCL)
#fix labels
df_SKN_NM$Comparison <- df_SKN_NM$contrast
#Create forest plot for differences of treatments within strains
SKN_NM_contrasts <- ggplot(df_SKN_NM, aes(x = Comparison, y = logHR)) +
geom_point(size = 4, color = '#4DBBD5FF') +
geom_hline(yintercept = 0, linetype = "dashed", size = 1.2) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, size = 1.1,color ='#4DBBD5FF')+
coord_flip() +
#scale_x_discrete(labels = c('N2 \n daf-2 - ev','SKN-1 \n daf-2 - ev'))+
labs(
title = "",
x = "Treatment comparison",
y = "Log hazard ratio (HR)"
) +
theme_minimal(base_size = 12)+
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.position = 'none')
SKN_NM_contrasts
#Create forest plot for differences of treatments within strains
SKN_NM_contrasts <- ggplot(df_SKN_NM, aes(x = Comparison, y = logHR)) +
geom_point(size = 4, color = '#4DBBD5FF') +
geom_hline(yintercept = 0, linetype = "dashed", size = 1.2, color = 'grey50') +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, size = 1.1,color ='#4DBBD5FF')+
coord_flip() +
#scale_x_discrete(labels = c('N2 \n daf-2 - ev','SKN-1 \n daf-2 - ev'))+
labs(
title = "",
x = "Treatment comparison",
y = "Log hazard ratio (HR)"
) +
theme_minimal(base_size = 12)+
theme(axis.text = element_text(size = 12),
axis.title = element_text(size = 14),
legend.position = 'none')
SKN_NM_contrasts
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, SKN_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot)
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="")+
labs(col="")+
theme(axis.title.y = element_text(size=14))+
theme(axis.title.x = element_text(size=14))+
theme(axis.text= element_text(size = 12))+
theme(legend.text = element_text(size = 12))+
scale_color_manual(values=c('#E64B35FF','#4DBBD5FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot, common.legend = T)
SKN_20C_all
#Survival plot
SKN_NM_LS_plot <-ggsurvplot(surv_SKN_NM, ylab="Survival probability\n", data = SKN_20C_LS_NM, size= 0.8, font.ylab= 14, font.xlab= 14, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "\nDay", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(12), font.legend = c(12))
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot, common.legend = T)
SKN_20C_all
#age-specific reproduction plot for SKN-1 mutants with daf or ev
skn_20C_p <-ggplot(data=skn_long, aes(x=factor(Day), y=value, group=Treatment, color=Treatment))+
geom_jitter(alpha = 0.2, position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.5))+
stat_summary(fun.data="mean_cl_boot", geom="errorbar", size = 1.2, width=0.0, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="point", size = 3, position = position_dodge(0.5)) +
stat_summary(fun.data="mean_cl_boot", geom="line",  size=1.2, position = position_dodge(0.5)) +
theme_classic()+
labs(y="Offspring number", x="Day")+
labs(col="")+
theme(axis.title.y = element_text(size=14))+
theme(axis.title.x = element_text(size=14))+
theme(axis.text= element_text(size = 12))+
theme(legend.text = element_text(size = 12))+
scale_color_manual(values=c('#E64B35FF','#4DBBD5FF'))+
theme(legend.key.width = unit(0.5,"cm"))+
coord_cartesian(ylim = c(0,225))+
theme(legend.position = c(0.1, 0.9))
skn_20C_p
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot, common.legend = T)
SKN_20C_all
#Create survival curve from survival object
SKN_20C_LS_plot <-ggsurvplot(surv_SKN, ylab="Survival probability\n", data = SKN_20C_LS, size= 0.8, font.ylab= 14, font.xlab= 14, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "Day", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(12), font.legend = c(12))
SKN_20C_LS_plot
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot, common.legend = T)
SKN_20C_all
#Create survival curve from survival object
SKN_20C_LS_plot <-ggsurvplot(surv_SKN, ylab="Survival probability\n", data = SKN_20C_LS, size= 0.8, font.ylab= 14, font.xlab= 14, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "Day", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(12), font.legend = c(12))
#Survival plot
SKN_NM_LS_plot <-ggsurvplot(surv_SKN_NM, ylab="Survival probability", data = SKN_20C_LS_NM, size= 0.8, font.ylab= 14, font.xlab= 14, palette=c('#E64B35FF','#4DBBD5FF'), legend = c(0.8, 0.8), legend.title = "", legend.labs = c('ev','daf-2'), title = "", censor = FALSE, xlab = "Day", xlim=c(0,35), break.time.by = 5, position= position_dodge(0.9), font.tickslab = c(12), font.legend = c(12))
SKN_NM_LS_plot
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot, common.legend = T)
SKN_20C_all
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot+theme(plot.margin = margin(t = 5, r = 25, b = 5, l = 25, unit = "pt")), common.legend = T)
SKN_20C_all
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot+theme(plot.margin = margin(t = 5, r = 10, b = 5, l = 25, unit = "pt")), heights = c(1.3, 1), common.legend = T, labels = c('A','B','C','D'))
SKN_20C_all
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot+theme(plot.margin = margin(t = 5, r = 10, b = 5, l = 40, unit = "pt")), heights = c(1.3, 1), common.legend = T, labels = c('A','B','C','D'))
SKN_20C_all
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts, tot_rep_SKN_plot+theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 40, unit = "pt")), heights = c(1.3, 1), common.legend = T, labels = c('A','B','C','D'))
SKN_20C_all
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts+theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 40, unit = "pt")), tot_rep_SKN_plot+theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 40, unit = "pt")), heights = c(1.3, 1), common.legend = T, labels = c('A','B','C','D'))
SKN_20C_all
SKN_20C_all <- ggarrange(SKN_NM_LS_plot$plot, skn_20C_p, SKN_NM_contrasts+theme(plot.margin = margin(t = 5, r = 5, b = 25, l = 40, unit = "pt")), tot_rep_SKN_plot+theme(plot.margin = margin(t = 5, r = 5, b = 5, l = 40, unit = "pt")), heights = c(1.3, 1), common.legend = T, labels = c('A','B','C','D'))
SKN_20C_all
ggsave("SKN_20C_all.png", plot = SKN_20C_all, bg = 'white',width = 12, height = 12, dpi = 300, units = "in")
ggsave("SKN_20C_all.png", plot = SKN_20C_all, bg = 'white',width = 12, height = 10, dpi = 300, units = "in")
#Matricides included for suppmat
SKN_20C_NM_all <- ggarrange(SKN_LS_plot$plot, SKN_contrasts, nrow = 2)
#Matricides included for suppmat
SKN_20C_NM_all <- ggarrange(skn_LS_plot$plot, SKN_contrasts, nrow = 2)
#Matricides included for suppmat
SKN_20C_NM_all <- ggarrange(skn_20C_LS_plot$plot, SKN_contrasts, nrow = 2)
#Matricides included for suppmat
SKN_20C_NM_all <- ggarrange(SKN_20C_LS_plot$plot, SKN_contrasts, nrow = 2)
#Matricides included for suppmat
SKN_20C_all <- ggarrange(SKN_20C_LS_plot$plot, SKN_contrasts, nrow = 2)
SKN_20C_all
SKN_20C_LS_all
#Matricides included for suppmat
SKN_20C_LS_all <- ggarrange(SKN_20C_LS_plot$plot, SKN_contrasts+theme(plot.margin = margin(t = 5, r = 25, b = 5, l = 25, unit = "pt")), nrow = 2, heights = c(2,1))
SKN_20C_LS_all
#Matricides included for suppmat
SKN_20C_LS_all <- ggarrange(SKN_20C_LS_plot$plot, SKN_contrasts+theme(plot.margin = margin(t = 5, r = 45, b = 5, l = 45, unit = "pt")), nrow = 2, heights = c(2,1))
SKN_20C_LS_all
#Matricides included for suppmat
SKN_20C_LS_all <- ggarrange(SKN_20C_LS_plot$plot, SKN_contrasts+theme(plot.margin = margin(t = 5, r = 45, b = 5, l = 45, unit = "pt")), nrow = 2, heights = c(2,1), common.legend = T)
SKN_20C_LS_all
ggsave("SKN_20C_LS_all.png", plot = SKN_20C_LS_all, bg = 'white',width = 8, height = 10, dpi = 300, units = "in")
